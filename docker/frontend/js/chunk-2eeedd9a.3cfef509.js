(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-2eeedd9a"],{"0487":function(e,t,a){"use strict";a.d(t,"c",(function(){return s})),a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return i}));var n=a("e20a"),s=function(e){return n.a.get("/scheduler/",{params:e})},r=function(e){return n.a.post("/scheduler/add/",e)},i=function(e){return n.a.post("/scheduler/delete/",e)}},"0fd1":function(e,t,a){"use strict";a.r(t);var n={props:{text:{type:[Array,Object]},record:{type:Object}}},s=a("2877"),r=Object(s.a)(n,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{},[e.text.length?a("div",e._l(e.text,(function(t,n){return a("p",{key:n},[e._v(" "+e._s(t.name))])})),0):a("div",[e._v("-")])])}),[],!1,null,"3cbdd361",null);t.default=r.exports},1660:function(e,t,a){},"17d0":function(e,t,a){"use strict";a.r(t),a("4160"),a("caad"),a("b0c0"),a("b64b"),a("d3b7"),a("2532"),a("159b");var n=a("5530"),s=a("90d8"),r={props:["scopeItem"],data:function(){return{form:this.$form.createForm(this),submitFLag:!1,initValue:{name:"",scope:""}}},methods:{subForm:function(){var e=this;this.form.validateFields((function(t,a){if(!t&&!e.submitFLag)if(e.submitFLag=!0,e.scopeItem)Object(s.c)({scope_id:e.scopeItem._id,scope:a.scope}).then((function(t){t.data.scope_id?(e.$message.success("提交成功"),e.$emit("freshTable"),e.handleCancel()):e.$message.error("提交失败")})).finally((function(){var t=setTimeout((function(){e.submitFLag=!1,clearTimeout(t)}),800)}));else{var r=Object(n.a)({},a);Object(s.d)(Object(n.a)({},r)).then((function(t){t.data.scope_id?(e.$message.success("提交成功"),e.$emit("freshTable"),e.handleCancel()):e.$message.error("提交失败")})).finally((function(){var t=setTimeout((function(){e.submitFLag=!1,clearTimeout(t)}),800)}))}}))},handleCancel:function(){this.$emit("closeModal")}}},i=(a("adf8"),a("2877")),o=Object(i.a)(r,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:e.scopeItem?"新建资产分组范围":"新建资产分组",visible:!0},on:{ok:e.subForm,cancel:e.handleCancel}},[a("a-form",{attrs:{form:e.form,"label-col":{span:7},"wrapper-col":{span:16}}},[a("a-form-item",{attrs:{label:"资产组名称"}},[e.scopeItem?a("span",[e._v(e._s(e.scopeItem.name))]):a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请选择资产组名称!"}],initialValue:e.initValue.name}],expression:"[\n          'name',\n          {\n            rules: [{ required: true, message: '请选择资产组名称!' }],\n            initialValue: initValue.name,\n          },\n        ]"}],attrs:{placeholder:"请输入资产组名称"}})],1),a("a-form-item",{attrs:{label:"资产范围"}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["scope",{rules:[{required:!0,message:"请输入域名, 如freebuf.com, live.freebuf.com, 输入多个目标用换行或逗号分隔!"}],initialValue:e.initValue.domain}],expression:"[\n          'scope',\n          {\n            rules: [{ required: true, message: '请输入域名, 如freebuf.com, live.freebuf.com, 输入多个目标用换行或逗号分隔!' }],\n            initialValue: initValue.domain,\n          },\n        ]"}],staticStyle:{height:"120px"},attrs:{placeholder:"请输入域名,如freebuf.com, live.freebuf.com, 输入多个目标用换行或逗号分隔"}})],1)],1)],1)}),[],!1,null,"d04f5aa0",null).exports,c=(a("99af"),a("0487")),l={props:["scopeItem"],data:function(){return{checkerType:!1,form:this.$form.createForm(this),submitFLag:!1,domainList:[],initNameValue:""}},mounted:function(){this.domainList=this.scopeItem?this.scopeItem.scope_array:[]},methods:{setName:function(e){this.initNameValue="监控-".concat(this.scopeItem.name,"-").concat(e)},checkNumber:function(e,t,a){t?t<6&&a(new Error("运行间隔时间不小于6小时")):a(new Error("请输入运行间隔时间")),a()},subForm:function(){var e=this;this.form.validateFields((function(t,a){if(!t&&!e.submitFLag){var s=Object(n.a)({scope_id:e.scopeItem._id},a);s.interval*=3600,e.submitFLag=!0,Object(c.a)(Object(n.a)({},s)).then((function(t){200===t.code?(e.$message.success("提交成功"),e.$emit("freshTable"),e.handleCancel()):e.$message.error("提交失败")})).finally((function(){var t=setTimeout((function(){e.submitFLag=!1,clearTimeout(t)}),800)}))}}))},handleCancel:function(){this.$emit("closeModal")}}},d=(a("5515"),Object(i.a)(l,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:"添加监控任务",visible:!0},on:{ok:e.subForm,cancel:e.handleCancel}},[a("a-form",{attrs:{form:e.form,"label-col":{span:5},"wrapper-col":{span:18}}},[a("a-form-item",{attrs:{label:"域名"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["domain",{rules:[{required:!0,message:"请选择域名"}]}],expression:"['domain', { rules: [{ required: true, message: '请选择域名' }]}]"}],attrs:{placeholder:"请选择域名"},on:{change:e.setName}},e._l(e.domainList,(function(t,n){return a("a-select-option",{key:n,attrs:{value:t}},[e._v(e._s(t))])})),1)],1),a("a-form-item",{attrs:{label:"名称"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入名称"}],initialValue:e.initNameValue}],expression:"['name', {\n            rules: [{ required: true, message: '请输入名称' }],\n            initialValue: initNameValue\n          }]"}],attrs:{placeholder:"请输入名称"}})],1),a("a-form-item",{attrs:{label:"运行间隔"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["interval",{rules:[{required:!0,validator:e.checkNumber}],initialValue:24}],expression:"['interval', {\n            rules: [{ required: true, validator: checkNumber }],\n            initialValue: 24\n          }]"}],staticStyle:{width:"310px","margin-right":"15px"},attrs:{placeholder:"请输入运行间隔",type:"number"}}),e._v("小时 ")],1)],1)],1)}),[],!1,null,"504c6430",null).exports),u=a("bc6a"),p={components:{addassetsGroup:o,addTask:d},data:function(){return{searchList:u.c,isLoading:!1,isAddAssets:!1,scopeItem:null,total:0,params:{page:1,size:10},optionId:0,isAddTask:!1,selectedRowKeys:[],columns:u.a,dataList:[]}},mounted:function(){this.$route.query.scope_id&&(this.params._id=this.$route.query.scope_id),this.initData()},methods:{changeCallback:function(e,t,a){var n;n=this.params.order?this.params.order.includes("-")?"":"-"+a.columnKey:a.columnKey,this.params.order=n,this.initData()},searchData:function(){this.params.page=1,this.params.size=10,this.initData()},operateCallback:function(e,t,a){switch(e){case"deleteTag":this.deleteAssets(t,a);break;case"deleteAssetsGourp":this.deleteAssetsGroup(t);break;case"addScopeAssets":this.addScopeAssets(t);break;case"addMonitor":this.addTask(t)}},deleteAssets:function(e,t){var a=this;Object(s.i)({scope_id:e,scope:t}).then((function(e){200===e.code&&(a.$message.success("删除成功"),a.searchData())}))},deleteAssetsGroup:function(e){var t=this;Object(s.h)({scope_id:[e]}).then((function(e){200===e.code&&(t.$message.success("删除成功"),t.searchData())}))},addTask:function(e){this.isAddTask=!0,this.scopeItem=e},addScopeAssets:function(e){this.scopeItem=e,this.isAddAssets=!0},deleteTaskOption:function(){var e=this;Object(s.h)({scope_id:this.selectedRowKeys}).then((function(t){200===t.code&&(e.$message.success("删除成功"),e.selectedRowKeys=[],e.searchData())}))},selectRowCallback:function(e){this.selectedRowKeys=e},initData:function(){var e=this,t={};Object.keys(this.params).forEach((function(a){void 0!==e.params[a]&&e.params[a]&&(t[a]=e.params[a])})),this.isLoading=!0,Object(s.m)(Object(n.a)({},t)).then((function(t){200===t.code?(t.items.forEach((function(e){e.key=e._id,e.title=e.name})),e.dataList=t.items,e.total=t.total,document.querySelector("#contentWrap").scrollTop=0):e.dataList=[]})).finally((function(){e.isLoading=!1}))},turnPageCallback:function(e,t){this.params.page=this.params.size===t?e:1,this.params.size=t,this.initData()}}},f=(a("6000"),Object(i.a)(p,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"taskList table-wrap"},[a("a-button",{staticClass:"newTaskBtn",attrs:{type:"primary"},on:{click:function(t){e.isAddAssets=!0,e.scopeItem=null}}},[e._v("新建资产分组")]),a("div",{staticClass:"search-wrap"},e._l(e.searchList,(function(t){return a("span",{key:t.key,staticClass:"item"},[a("span",{staticClass:"label"},[e._v(e._s(t.name)+"：")]),a("a-input-search",{staticStyle:{width:"250px"},attrs:{allowClear:"",placeholder:"请输入"+t.name+"进行搜索"},on:{search:e.searchData},model:{value:e.params[t.key],callback:function(a){e.$set(e.params,t.key,a)},expression:"params[item.key]"}})],1)})),0),a("batch-delete",{attrs:{selectedRowKeys:e.selectedRowKeys},on:{deleteCallback:e.deleteTaskOption}}),a("table-component",{attrs:{columns:e.columns,isSelect:!0,selectedRowKeys:e.selectedRowKeys,tableList:e.dataList,isLoading:e.isLoading,pagination:!1,scroll:{x:1500},total:e.total,params:e.params},on:{selectRowCallback:e.selectRowCallback,turnPageCallback:e.turnPageCallback,operateCallback:e.operateCallback,changeCallback:e.changeCallback}}),e.isAddAssets?a("addassets-group",{attrs:{scopeItem:e.scopeItem},on:{closeModal:function(t){e.isAddAssets=!1},freshTable:e.initData}}):e._e(),e.isAddTask?a("add-task",{attrs:{scopeItem:e.scopeItem},on:{closeModal:function(t){e.isAddTask=!1},freshTable:e.searchData}}):e._e()],1)}),[],!1,null,"1cd2ca50",null));t.default=f.exports},"1b78":function(e,t,a){"use strict";a.r(t),a("a9e3");var n={props:{text:{type:Number},record:{type:Object}},methods:{watchTask:function(e){this.$router.push({name:"taskList",query:{searchId:e}})}}},s=a("2877"),r=Object(s.a)(n,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("a",{staticStyle:{color:"#00c5dc"},attrs:{href:"javascript:void(0)"},on:{click:function(t){return e.watchTask(e.record.task_id)}}},[e._v(e._s(e.text))])}),[],!1,null,"93dfafaa",null);t.default=r.exports},"1bdf":function(e,t,a){"use strict";a.r(t);var n={props:{text:{type:String},record:{type:Object}}},s=a("2877"),r=Object(s.a)(n,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("span",{staticClass:"ftColor",attrs:{title:e.text},on:{click:function(t){return e.$router.push({name:"groupAssetsDetail",query:{scope_id:e.record._id,target:e.record.name}})}}},[e._v(e._s(e.text.length>26?e.text.slice(0,26)+"...":e.text))])}),[],!1,null,"e94022a6",null);t.default=r.exports},"2e61":function(e,t,a){"use strict";a.r(t);var n={props:{text:{type:String},record:{type:Object}}},s=a("2877"),r=Object(s.a)(n,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{},[a("a",{staticStyle:{color:"#00c5dc"},attrs:{href:e.text,target:"_blank"}},[e.record.favicon&&e.record.favicon.data?a("img",{staticClass:"site-img",attrs:{src:"data:image/png;base64,"+e.record.favicon.data,alt:""}}):e._e(),e._v(" "+e._s(e.text))]),e.record.favicon&&e.record.favicon.hash?a("p",{staticClass:"site-word"},[e._v(" Favicon Hash: "+e._s(e.record.favicon.hash))]):e._e()])}),[],!1,null,"1d7bc921",null);t.default=r.exports},3976:function(e,t,a){"use strict";var n=a("664c");a.n(n).a},"3d6d":function(e,t,a){"use strict";var n=a("1660");a.n(n).a},"4ec0":function(e,t,a){"use strict";a.r(t);var n={props:{text:{type:String},record:{type:Object}},methods:{deleteTaskOption:function(e){this.$emit("operateCallback","deleteAssetsGourp",e)},addMonitorTask:function(e){this.$emit("operateCallback","addMonitor",e)},addScopeAssets:function(e){this.$emit("operateCallback","addScopeAssets",e)}}},s=(a("7f6eb"),a("2877")),r=Object(s.a)(n,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{},[a("a-button",{staticClass:"operate-link",on:{click:function(t){return e.addScopeAssets(e.record)}}},[e._v("添加资产分组范围")]),a("a-button",{staticClass:"operate-link",on:{click:function(t){return e.addMonitorTask(e.record)}}},[e._v("添加监控任务")]),a("a-popconfirm",{attrs:{"ok-text":"确认","cancel-text":"取消"},on:{confirm:function(t){return e.deleteTaskOption(e.record._id)}}},[a("template",{slot:"title"},[a("p",[e._v("删除后不可恢复，确认删除吗？")])]),a("a-button",{staticClass:"operate-link"},[e._v("删除")])],2)],1)}),[],!1,null,"64974da2",null);t.default=r.exports},5515:function(e,t,a){"use strict";var n=a("afe3");a.n(n).a},6e3:function(e,t,a){"use strict";var n=a("a074");a.n(n).a},6609:function(e,t,a){"use strict";a.r(t);var n={props:{text:{type:String},record:{type:Object}}},s=a("2877"),r=Object(s.a)(n,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"scroll-x"},[this.text?t("pre",[this._v(this._s(this.text))]):t("div",[this._v("-")])])}),[],!1,null,"2d7fad56",null);t.default=r.exports},"664c":function(e,t,a){},"7f6eb":function(e,t,a){"use strict";var n=a("99d9");a.n(n).a},"90d8":function(e,t,a){"use strict";a.d(t,"m",(function(){return s})),a.d(t,"d",(function(){return r})),a.d(t,"c",(function(){return i})),a.d(t,"i",(function(){return o})),a.d(t,"h",(function(){return c})),a.d(t,"j",(function(){return l})),a.d(t,"k",(function(){return d})),a.d(t,"l",(function(){return u})),a.d(t,"g",(function(){return p})),a.d(t,"f",(function(){return f})),a.d(t,"e",(function(){return m})),a.d(t,"b",(function(){return h})),a.d(t,"a",(function(){return b}));var n=a("e20a"),s=function(e){return n.a.get("/asset_scope/",{params:e})},r=function(e){return n.a.post("/asset_scope/",e)},i=function(e){return n.a.post("/asset_scope/add/",e)},o=function(e){return n.a.get("/asset_scope/delete/",{params:e})},c=function(e){return n.a.post("/asset_scope/delete/",e)},l=function(e){return n.a.get("/asset_domain/",{params:e})},d=function(e){return n.a.get("/asset_ip/",{params:e})},u=function(e){return n.a.get("/asset_site/",{params:e})},p=function(e){return n.a.post("/asset_site/delete/",e)},f=function(e){return n.a.post("/asset_ip/delete/",e)},m=function(e){return n.a.post("/asset_domain/delete/",e)},h=function(e){return n.a.post("/asset_site/",e)},b=function(e){return n.a.post("/asset_domain/",e)}},9348:function(e,t,a){var n={"./arrTip.vue":"e286","./dataIndex.vue":"1b78","./finger.vue":"0fd1","./headers.vue":"6609","./name.vue":"1bdf","./operate.vue":"4ec0","./site.vue":"2e61","./tag.vue":"c09b"};function s(e){var t=r(e);return a(t)}function r(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}s.keys=function(){return Object.keys(n)},s.resolve=r,e.exports=s,s.id="9348"},"99d9":function(e,t,a){},a074:function(e,t,a){},adf8:function(e,t,a){"use strict";var n=a("fab6");a.n(n).a},afe3:function(e,t,a){},bc6a:function(e,t,a){"use strict";a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return l})),a("b0c0");var n=a("90d8"),s=(a("4160"),a("d3b7"),a("ac1f"),a("466d"),a("159b"),a("ddb0"),a("9348")),r={};s.keys().forEach((function(e){r[e.match(/(\.\/)(\w*)/)[2]]=s(e).default}));var i=r,o=[{name:"资产组名称",key:"name"},{name:"资产范围",key:"scope"},{name:"资产范围ID",key:"_id"}],c=[{title:"资产组名称",dataIndex:"title",fixed:"left",sorter:!0,scopedSlots:{customRender:"name",component:i.name}},{title:"资产范围",dataIndex:"scope_array",scopedSlots:{customRender:"scope_array",component:i.tag}},{title:"资产范围ID",dataIndex:"_id",scopedSlots:{customRender:"_id",component:i.name}},{width:400,title:"操作",dataIndex:"operate",scopedSlots:{customRender:"operate",component:i.operate}}],l=[{columns:[{width:80,title:"序号",dataIndex:"index",scopedSlots:{customRender:"dataIndex",component:i.dataIndex}},{width:300,title:"站点",dataIndex:"site",scopedSlots:{customRender:"site",component:i.site}},{width:300,title:"标题",dataIndex:"title"},{width:400,title:"headers",dataIndex:"headers",scopedSlots:{customRender:"headers",component:i.headers}},{width:200,title:"finger",dataIndex:"_fingerName",scopedSlots:{customRender:"finger",component:i.finger}},{width:300,title:"更新时间",dataIndex:"update_date"}],api:n.l,addAPI:n.b,deleteAPI:n.g,searchGroup:[{label:"站点",value:"site",filterType:"input"},{label:"主机名",value:"hostname",filterType:"input"},{label:"标题",value:"title",filterType:"input"},{label:"Web Server",value:"http_server",filterType:"input"},{label:"状态码",value:"status",filterType:"input"},{label:"标头",value:"headers",filterType:"input"},{label:"指 纹",value:"finger.name",filterType:"input"},{label:"favicon hash",value:"favicon.hash",filterType:"input"},{label:"更新时间",value:"update_date",filterType:"date"}],total:0,params:{page:1,size:10}},{columns:[{width:100,title:"序号",dataIndex:"index",scopedSlots:{customRender:"dataIndex",component:i.dataIndex}},{width:300,title:"域名",dataIndex:"domain"},{width:100,title:"解析类型",dataIndex:"type"},{width:150,title:"记录值",dataIndex:"record",scopedSlots:{customRender:"record",component:i.arrTip}},{width:120,title:"关联IP",dataIndex:"ips",scopedSlots:{customRender:"ips",component:i.arrTip}},{width:100,title:"来源",dataIndex:"source"},{width:300,title:"更新时间",dataIndex:"update_date"}],total:0,api:n.j,addAPI:n.a,deleteAPI:n.e,searchGroup:[{label:"域名",value:"domain",filterType:"input"},{label:"记录值",value:"record",filterType:"input"},{label:"类型",value:"type",filterType:"input"},{type:"number",label:"IP",value:"ips",filterType:"input"},{label:"来源",value:"source",filterType:"input"},{label:"更新时间",value:"update_date",filterType:"date"}],params:{page:1,size:10}},{columns:[{width:100,title:"序号",dataIndex:"index",scopedSlots:{customRender:"dataIndex",component:i.dataIndex}},{width:200,title:"IP",dataIndex:"ip"},{width:250,title:"操作系统",dataIndex:"_osName"},{width:320,title:"开放端口",dataIndex:"port"},{width:300,title:"关联域名",dataIndex:"domain",scopedSlots:{customRender:"domain",component:i.arrTip}},{width:200,title:"Geo",dataIndex:"geo_city"},{width:300,title:"AS",dataIndex:"geo_asn"},{width:300,title:"更新时间",dataIndex:"update_date"}],total:0,api:n.k,addAPI:"",deleteAPI:n.f,searchGroup:[{type:"number",label:"IP",value:"ip",filterType:"input"},{type:"number",label:"端口",value:"port_info.port_id",filterType:"input"},{label:"操作系统",value:"os_info.name",filterType:"input"},{label:"域名",value:"domain",filterType:"input"},{label:"更新时间",value:"update_date",filterType:"date"}],params:{page:1,size:10}}]},c09b:function(e,t,a){"use strict";a.r(t);var n={props:{text:{type:Array||String,default:function(){return[]}},record:{type:Object}},methods:{deleteAssets:function(e,t){this.$emit("operateCallback","deleteTag",e,t)}}},s=(a("3d6d"),a("2877")),r=Object(s.a)(n,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.text.length?a("div",e._l(e.text,(function(t,n){return a("div",{key:n,staticClass:"tag-wrap"},[a("a-tag",{attrs:{visible:!0,closable:""},on:{close:function(a){return e.deleteAssets(e.record._id,t)}}},[e._v(" "+e._s(t)+" ")])],1)})),0):a("div",[e._v("-")])])}),[],!1,null,"01289d83",null);t.default=r.exports},e286:function(e,t,a){"use strict";a.r(t);var n={props:{text:{type:Array},record:{type:Object}}},s=(a("3976"),a("2877")),r=Object(s.a)(n,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{},[void 0!==e.text&&e.text.length?a("div",[e.text.length>5?a("div",[a("a-tooltip",{attrs:{placement:"topLeft"}},[a("template",{slot:"title"},e._l(e.text,(function(t,n){return a("p",{key:n},[e._v(e._s(t))])})),0),e._l(e.text.slice(0,5),(function(t,n){return a("p",{key:n},[e._v(" "+e._s(4===n?t+"...":t)+" ")])}))],2)],1):a("div",e._l(e.text,(function(t,n){return a("p",{key:n},[e._v(e._s(t))])})),0)]):a("div",[e._v("-")])])}),[],!1,null,"5fffb49a",null);t.default=r.exports},fab6:function(e,t,a){}}]);